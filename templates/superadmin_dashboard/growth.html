<!-- templates/admin_dashboard/growth.html -->
{% extends '__base.html' %}

{% block title %}تحلیل رشد{% endblock %}

{% block content %}
<h2 class="my-4">تحلیل رشد سیستم</h2>

<div class="row g-4">
  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5>افزایش کاربران (ماهانه)</h5>
        <canvas id="usersChart"></canvas>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5>فروش ماهانه (تومان)</h5>
        <canvas id="salesChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Data Tables -->
<div class="mt-4">
  <h5>آمار ماهانه</h5>
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>ماه</th>
        <th>کاربران جدید</th>
        <th>درآمد (تومان)</th>
        <th>سفارشات</th>
      </tr>
    </thead>
    <tbody>
      {% for month in monthly_stats %}
      <tr>
        <td>{{ month.name }}</td>
        <td>{{ month.new_users }}</td>
        <td>{{ month.revenue|numberformat }}</td>
        <td>{{ month.orders }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const usersCtx = document.getElementById('usersChart').getContext('2d');
  new Chart(usersCtx, {
    type: 'line',
    data: {
      labels: {{ chart_months|safe }},
      datasets: [{
        label: 'کاربران جدید',
        data: {{ user_data|safe }},
        borderColor: '#275DAD',
        tension: 0.3
      }]
    }
  });
</script>

{% endblock %}