<!-- templates/admin_dashboard/impersonation.html -->
{% extends "admin_dashboard/_base.html" %}

{% block title %}تجسم کاربر (Impersonate){% endblock %}

{% block mainContent %}
<div class="container-fluid px-4">
  <h2 class="my-4 text-white">تجسم کاربر (Impersonate)</h2>

  <!-- Warning Alert -->
  <div class="alert alert-warning mb-4">
    <strong>⚠️ هشدار امنیتی:</strong>
    شما در حال ورود به سیستم به عنوان یک کاربر دیگر هستید.
    این قابلیت فقط برای عیب‌یابی و پشتیبانی استفاده شود.
    <br>
    <small class="text-muted">آخرین ورود شما به عنوان مدیر ثبت خواهد شد.</small>
  </div>

  <div class="card shadow-sm border-0">
    <div class="card-body p-4">
      <form method="post">
        {% csrf_token %}

        <div class="mb-3">
          <label for="user_select" class="form-label">انتخاب کاربر</label>
          {% if users %}
            <select class="form-control" id="user_select" name="user_id" required>
              <option value="">-- انتخاب کاربر --</option>
              {% for user in users %}
                <option value="{{ user.id }}">
                  {{ user.get_full_name|default:user.username }} ({{ user.email }})
                </option>
              {% endfor %}
            </select>
          {% else %}
            <select class="form-control" disabled>
              <option>هیچ کاربری یافت نشد</option>
            </select>
          {% endif %}
        </div>

        <div class="d-flex gap-2">
          {% if users %}
            <button type="submit" class="btn btn-warning px-4">
              <i class="fas fa-mask"></i> شروع تجسم کاربر
            </button>
          {% endif %}
          <a href="{% url 'admin:admin-dashboard' %}" class="btn btn-secondary px-4">
            <i class="fas fa-times"></i> انصراف
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Optional: Info Box -->
  <div class="mt-4 p-3 bg-dark text-white rounded-3 border">
    <h6><i class="fas fa-info-circle"></i> راهنمای تجسم کاربر</h6>
    <ul class="mb-0 small">
      <li>پس از ورود به حساب کاربر، نوار بالایی قرمز نشان‌دهنده حالت تجسم است.</li>
      <li>برای خروج از حالت تجسم، روی "بازگشت به حساب مدیر" کلیک کنید.</li>
      <li>تمام اقدامات شما در لاگ‌ها ثبت می‌شود.</li>
    </ul>
  </div>
</div>

{% endblock %}