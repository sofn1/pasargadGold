<!-- templates/admin_dashboard/sellers.html -->
{% extends "admin_dashboard/_base.html" %}

{% block title %}فروشندگان{% endblock %}

{% block mainContent %}
<div class="container-fluid px-4">
  <h2 class="my-4 text-white">فروشندگان</h2>

  <!-- Search & Create -->
  <div class="d-flex justify-content-between flex-wrap gap-2 mb-4">
    <form class="d-flex flex-grow-1" method="get" style="max-width: 400px;">
      <input class="form-control me-2"
             type="search"
             name="q"
             placeholder="جستجوی فروشنده..."
             value="{{ request.GET.q|default:'' }}">
      <button class="btn btn-outline-light" type="submit">
        <i class="fas fa-search"></i>
      </button>
    </form>
    <a href="{% url 'admin:admin_seller_create' %}"
       class="btn btn-success d-flex align-items-center gap-1">
      <i class="fas fa-user-plus"></i> افزودن فروشنده
    </a>
  </div>

  <!-- Sellers Table -->
  <div class="card shadow-sm border-0">
    <div class="card-body p-0">
      {% if sellers %}
        <div class="table-responsive">
          <table class="table table-hover mb-0 align-middle">
            <thead class="table-dark">
              <tr>
                <th>نام فروشگاه</th>
                <th>مالک</th>
                <th>تلفن</th>
                <th>محصولات</th>
                <th>وضعیت</th>
                <th>عملیات</th>
              </tr>
            </thead>
            <tbody>
              {% for seller in sellers %}
              <tr>
                <td>
                  <strong>{{ seller.shop_name|truncatechars:30 }}</strong>
                </td>
                <td>{{ seller.owner_name|default:"نامشخص" }}</td>
                <td class="text-nowrap ltr-text">{{ seller.phone }}</td>
                <td>
                  <span class="badge bg-primary">{{ seller.product_count }}</span>
                </td>
                <td>
                  {% if seller.is_active %}
                    <span class="badge bg-success">فعال</span>
                  {% else %}
                    <span class="badge bg-secondary">غیرفعال</span>
                  {% endif %}
                </td>
                <td class="text-nowrap">
                  <a href="{% url 'admin:admin_seller_update' seller.id %}"
                     class="btn btn-sm btn-outline-primary me-1"
                     title="ویرایش">
                    <i class="fas fa-edit"></i>
                  </a>
                  <a href="{% url 'admin:admin_seller_delete' seller.id %}"
                     class="btn btn-sm btn-outline-danger"
                     title="حذف"
                     onclick="return confirm('آیا از حذف این فروشنده اطمینان دارید؟ تمام محصولات و داده‌ها حذف خواهند شد.')">
                    <i class="fas fa-trash"></i>
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        {% if sellers.has_other_pages %}
          <nav class="p-3 bg-light bg-opacity-10 border-top">
            <ul class="pagination justify-content-center mb-0">
              {% if sellers.has_previous %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ sellers.previous_page_number }}&q={{ request.GET.q|urlencode }}">قبلی</a>
                </li>
              {% else %}
                <li class="page-item disabled"><span class="page-link">قبلی</span></li>
              {% endif %}

              {% for i in sellers.paginator.page_range %}
                <li class="page-item {% if sellers.number == i %}active{% endif %}">
                  <a class="page-link" href="?page={{ i }}&q={{ request.GET.q|urlencode }}">{{ i }}</a>
                </li>
              {% endfor %}

              {% if sellers.has_next %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ sellers.next_page_number }}&q={{ request.GET.q|urlencode }}">بعدی</a>
                </li>
              {% else %}
                <li class="page-item disabled"><span class="page-link">بعدی</span></li>
              {% endif %}
            </ul>
          </nav>
        {% endif %}

      {% else %}
        <div class="text-center p-5 text-muted">
          <i class="fas fa-store-slash fa-2x opacity-50 mb-3"></i>
          <p class="mb-0">فروشنده‌ای یافت نشد.</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<style>
  .ltr-text {
    direction: ltr;
    text-align: left;
    font-family: monospace;
  }
</style>

{% endblock %}