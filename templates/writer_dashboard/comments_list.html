{% extends "base.html" %}
{% load static %}

{% block content %}
<section class="max-w-5xl mx-auto p-6">
  <h1 class="text-2xl font-bold text-[#1C39BB] mb-6">نظرات</h1>

  {% for comment in comments %}
  <div class="mb-4 border rounded-lg p-4 bg-white shadow">
    <p class="text-sm text-gray-700">{{ comment.user.username }}:</p>
    <p class="text-md mt-1">{{ comment.content }}</p>
    <p class="text-xs text-gray-400">{{ comment.created_at|date:"Y-m-d H:i" }}</p>

    {% if comment.replies.all %}
      <div class="ml-4 mt-2 border-l pl-4">
        {% for reply in comment.replies.all %}
          <div class="mb-2">
            <strong class="text-sm text-[#1C39BB]">{{ reply.user.username }}:</strong>
            <p class="text-sm">{{ reply.content }}</p>
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <form method="POST" action="{% url 'writer_reply_to_comment' comment.id %}" class="mt-3">
      {% csrf_token %}
      <input type="text" name="content" placeholder="پاسخ شما..." class="w-full border rounded p-2">
      <button type="submit" class="mt-2 px-4 py-2 bg-[#1C39BB] text-white rounded">ارسال پاسخ</button>
    </form>
  </div>
  {% empty %}
  <p class="text-center text-gray-500">نظری وجود ندارد.</p>
  {% endfor %}
</section>
{% endblock %}
